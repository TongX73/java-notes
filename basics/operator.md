# Java 运算符全面详解

## 一、算术运算符

### 1. 基本算术运算符
| 运算符 | 名称 | 示例      | 说明                      |
|--------|------|-----------|---------------------------|
| `+`    | 加法 | `5 + 3`   | 结果为8                   |
| `-`    | 减法 | `10 - 2`  | 结果为8                   |
| `*`    | 乘法 | `3 * 4`   | 结果为12                  |
| `/`    | 除法 | `10 / 3`  | 整数除法结果为3           |
| `%`    | 取模 | `10 % 3`  | 结果为1（余数）           |

### 2. 类型转换规则
#### (1) 隐式转换（自动类型提升）
```java
int a = 10;
double b = 3.5;
double result = a + b; // int自动提升为double

byte x = 5;
byte y = 10;
// byte z = x + y; // 错误！byte运算前转为int，结果需强制转换
int z = x + y;      // 正确
```

**类型提升规则**：
1. `byte`、`short`、`char` → `int`
2. `int` → `long` → `float` → `double`
3. 小类型与大类型运算，小类型自动提升为大类型

#### (2) 强制转换
```java
double pi = 3.14159;
int intPi = (int) pi;   // 结果为3（直接截断小数部分）

long bigValue = 1234567890123L;
int intValue = (int) bigValue; // 可能溢出（精度损失）
```

**注意事项**：
- 强制转换可能导致数据溢出或精度损失
- 浮点转整数时直接舍弃小数部分（非四舍五入）

### 3. 字符串的 `+` 操作
```java
System.out.println("Java" + 11);     // "Java11"
System.out.println(10 + 20 + "30");  // "3030" → 先计算10+20=30，再+"30"
System.out.println("" + 10 + 20);    // "1020" → 字符串开头，后续全按字符串拼接

// 字符参与运算
System.out.println('A' + 1);        // 66（A的ASCII码65+1）
System.out.println("A" + 1);         // "A1"
System.out.println('A' + '1');       // 65+49=114（字符'1'的ASCII码是49）
```

## 二、自增自减运算符

### 1. 基本用法
| 运算符 | 名称   | 示例     | 等效表达式     | 结果（假设i初值为5） |
|--------|--------|----------|---------------|----------------------|
| `++i`  | 前自增 | `j = ++i`| `i=i+1; j=i;` | i=6, j=6            |
| `i++`  | 后自增 | `j = i++`| `j=i; i=i+1;` | i=6, j=5            |
| `--i`  | 前自减 | `j = --i`| `i=i-1; j=i;` | i=4, j=4            |
| `i--`  | 后自减 | `j = i--`| `j=i; i=i-1;` | i=4, j=5            |

### 2. 使用注意事项
```java
int x = 10;
int y = x++ + ++x; 
// 分解步骤：
// 第一步：x++ → 表达式值10，然后x=11
// 第二步：++x → x先变为12，表达式值12
// 结果：y = 10 + 12 = 22

// 避免在复杂表达式中混合使用自增/自减
```

## 三、赋值运算符

### 1. 基本赋值运算符
```java
int a = 10; // 基本赋值
```

### 2. 复合赋值运算符
| 运算符 | 示例       | 等效表达式      |
|--------|------------|-----------------|
| `+=`   | `a += 5`   | `a = a + 5`     |
| `-=`   | `a -= 3`   | `a = a - 3`     |
| `*=`   | `a *= 2`   | `a = a * 2`     |
| `/=`   | `a /= 4`   | `a = a / 4`     |
| `%=`   | `a %= 3`   | `a = a % 3`     |

### 3. 复合赋值的特点
```java
byte b = 10;
// b = b + 5; // 错误！需要强制转换
b += 5;      // 正确！隐含强制转换（等价于 b = (byte)(b + 5)）

int x = 5;
x *= 3 + 2; // 等价于 x = x * (3+2) → 25
```

## 四、关系运算符

| 运算符 | 名称     | 示例       | 结果（设a=5, b=3） |
|--------|----------|------------|---------------------|
| `==`   | 等于     | `a == b`   | false              |
| `!=`   | 不等于   | `a != b`   | true               |
| `>`    | 大于     | `a > b`    | true               |
| `<`    | 小于     | `a < b`    | false              |
| `>=`   | 大于等于 | `a >= b`   | true               |
| `<=`   | 小于等于 | `a <= b`   | false              |

**注意事项**：
- 关系运算的结果为布尔值（`true`/`false`）
- 不可将 `==` 误写为 `=`
- 浮点数比较应避免直接使用 `==`（精度问题）
  ```java
  double d1 = 0.1 + 0.2;
  double d2 = 0.3;
  System.out.println(d1 == d2); // false! 实际d1=0.30000000000000004
  ```

## 五、逻辑运算符

### 1. 基本逻辑运算符
| 运算符 | 名称 | 说明                     | 示例                      |
|--------|------|--------------------------|---------------------------|
| `&`    | 逻辑与 | 全真为真                 | `true & false` → `false`  |
| `|`    | 逻辑或 | 有真即真                 | `true | false` → `true`   |
| `^`    | 逻辑异或 | 不同为真，相同为假       | `true ^ true` → `false`   |
| `!`    | 逻辑非 | 取反                     | `!true` → `false`         |

### 2. 真值表
| A     | B     | A & B | A \| B | A ^ B | !A    |
|-------|-------|-------|--------|-------|-------|
| true  | true  | true  | true   | false | false |
| true  | false | false | true   | true  | false |
| false | true  | false | true   | true  | true  |
| false | false | false | false  | false | true  |

## 六、短路逻辑运算符

### 1. 短路特性
| 运算符 | 名称   | 特点                               | 示例                         |
|--------|--------|------------------------------------|------------------------------|
| `&&`   | 短路与 | 左假则右不执行                     | `false && (x > 0)` → 不计算右边 |
| `||`   | 短路或 | 左真则右不执行                     | `true || (y < 0)` → 不计算右边  |

### 2. 应用实例
```java
// 避免空指针异常
String str = null;
if (str != null && str.length() > 0) {
    // 安全：当str为null时，右侧不执行
}

// 避免除零错误
int x = 10;
int y = 0;
if (y != 0 && x / y > 5) {
    // 安全：y为0时跳过计算
}
```

## 七、三元运算符

### 1. 基本语法
```java
数据类型 变量名 = 布尔表达式 ? 表达式1 : 表达式2;
```

### 2. 使用示例
```java
// 基本用法
int score = 85;
String result = score >= 60 ? "及格" : "不及格";

// 嵌套三元
String level = score >= 90 ? "优秀" : 
               score >= 80 ? "良好" :
               score >= 70 ? "中等" :
               score >= 60 ? "及格" : "不及格";

// 与赋值结合
int a = 10, b = 20;
int max = (a > b) ? a : b;
```

### 3. 注意事项
- 表达式1和表达式2的类型必须兼容（可自动转换或同类型）
- 三元运算符可替代简单的if-else结构
- 避免过度嵌套（降低可读性）

## 八、位运算符（补充）

### 1. 基本位运算符
| 运算符 | 名称       | 示例          | 说明                    |
|--------|------------|---------------|-------------------------|
| `&`    | 按位与     | `5 & 3` (0101 & 0011) → 0001 (1) | 同1为1                 |
| `|`    | 按位或     | `5 | 3` → 0111 (7)          | 有1为1                 |
| `^`    | 按位异或   | `5 ^ 3` → 0110 (6)          | 不同为1                |
| `~`    | 按位取反   | `~5` → ...1111010 (补码表示) | 0变1，1变0            |
| `<<`   | 左移       | `5 << 1` → 1010 (10)        | 低位补0，相当于乘2     |
| `>>`   | 右移       | `-5 >> 1`                  | 高位补符号位，相当于除2（向下取整） |
| `>>>`  | 无符号右移 | `-5 >>> 1`                 | 高位补0                |

### 2. 应用场景
```java
// 快速乘除2的幂次
int n = 8;
int doubleN = n << 1; // 16
int halfN = n >> 1;   // 4

// 交换两个数（不用临时变量）
int a = 5, b = 10;
a = a ^ b;
b = a ^ b; // b = 5
a = a ^ b; // a = 10

// 判断奇偶
boolean isEven = (num & 1) == 0;
```

## 九、运算符优先级

### 1. 常见运算符优先级（从高到低）
| 优先级 | 运算符                             | 结合性   |
|--------|------------------------------------|----------|
| 1      | `()` `[]` `.`                      | 从左到右 |
| 2      | `!` `~` `++` `--` `+(正)` `-(负)` | 从右到左 |
| 3      | `*` `/` `%`                        | 从左到右 |
| 4      | `+` `-`                            | 从左到右 |
| 5      | `<<` `>>` `>>>`                    | 从左到右 |
| 6      | `<` `<=` `>` `>=` `instanceof`     | 从左到右 |
| 7      | `==` `!=`                          | 从左到右 |
| 8      | `&`                                | 从左到右 |
| 9      | `^`                                | 从左到右 |
| 10     | `|`                                | 从左到右 |
| 11     | `&&`                               | 从左到右 |
| 12     | `||`                               | 从左到右 |
| 13     | `?:`                               | 从右到左 |
| 14     | `=` `+=` `-=` `*=` `/=` `%=` 等     | 从右到左 |

### 2. 优先级示例
```java
int result = 5 + 3 * 2;   // 11（乘法优先）
boolean flag = 10 > 5 && 3 < 2; // false（先计算关系运算，再逻辑与）
```

**最佳实践**：不确定优先级时使用括号明确运算顺序
```java
// 使用括号增强可读性
int complex = (a * b) + (c / d) - (e % f);
boolean condition = (a > b) || ((c < d) && (e != f));
```

## 十、运算符综合应用

### 1. 类型转换综合案例
```java
byte b = 10;
short s = 20;
char c = 'A';
int i = 30;
double d = 5.5;

// 混合运算
double result = b + s + c + i + d; 
// 所有类型最终提升为double
```

### 2. 复合赋值与类型转换
```java
int x = 10;
x += 3.5; // 等价于 x = (int)(x + 3.5); → 13

double y = 10;
y += 3.5; // y = 13.5
```

### 3. 三元运算符类型处理
```java
Object result = true ? "字符串" : 100; 
// 结果类型为Object（String和Integer的共同父类）

double value = true ? 10 : 3.14; 
// 10自动提升为double
```
